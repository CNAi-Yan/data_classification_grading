spring:
  application:
    name: sensitive-data-detector
  
  # Kafka配置 - 开发环境使用本地Kafka
  kafka:
    bootstrap-servers: localhost:9092
    consumer:
      group-id: sensitive-data-detector-group-dev
      auto-offset-reset: earliest
      key-deserializer: org.apache.kafka.common.serialization.StringDeserializer
      value-deserializer: org.apache.kafka.common.serialization.StringDeserializer
    producer:
      key-serializer: org.apache.kafka.common.serialization.StringSerializer
      value-serializer: org.apache.kafka.common.serialization.StringSerializer
      acks: 1
  
  # Redis配置 - 开发环境使用本地Redis
  redis:
    host: localhost
    port: 6379
    database: 1
    timeout: 5000ms
    lettuce:
      pool:
        max-active: 50
        max-idle: 10
        min-idle: 5
        max-wait: -1ms
  
  # 缓存配置 - 开发环境较短的过期时间
  cache:
    caffeine:
      spec: maximumSize=1000,expireAfterWrite=5m
  
  # 服务注册与发现配置 - 开发环境禁用
  cloud:
    consul:
      enabled: false
    config:
      enabled: false
      import: "optional:configserver:"
      import-check:
        enabled: false
    gateway:
      enabled: false
  
  # 数据库配置 - 开发环境使用MySQL
  datasource:
    url: jdbc:mysql://localhost:3306/sensitive_data_dev?useUnicode=true&characterEncoding=utf-8&useSSL=false&serverTimezone=Asia/Shanghai
    driver-class-name: com.mysql.cj.jdbc.Driver
    username: root
    password: password
  
  # JPA配置 - 开发环境显示SQL
  jpa:
    database-platform: org.hibernate.dialect.MySQL8Dialect
    hibernate:
      ddl-auto: update
    show-sql: true
    properties:
      hibernate.format_sql: true

# 服务端口 - 开发环境使用8080
server:
  port: 8080
  error:
    include-stacktrace: always

# 网关配置 - 禁用
spring.cloud.gateway:
  enabled: false

# 限流配置 - 开发环境较宽松的限流
resilience4j:
  ratelimiter:
    instances:
      sensitiveDataDetector:
        limitForPeriod: 10000
        limitRefreshPeriod: 1s
        timeoutDuration: 1000ms
  
  circuitbreaker:
    instances:
      sensitiveDataDetector:
        registerHealthIndicator: true
        slidingWindowSize: 50
        minimumNumberOfCalls: 5
        permittedNumberOfCallsInHalfOpenState: 5
        automaticTransitionFromOpenToHalfOpenEnabled: true
        waitDurationInOpenState: 3s
        failureRateThreshold: 70

# 性能监控配置
management:
  endpoints:
    web:
      exposure:
        include: health,metrics,prometheus,info,env
  metrics:
    export:
      prometheus:
        enabled: true
  endpoint:
    health:
      show-details: always

# 应用配置 - 开发环境较低的线程池配置
sensitive:
  data:
    detector:
      # 检测线程池配置
      thread-pool:
        core-size: 5
        max-size: 20
        queue-capacity: 500
        keep-alive-time: 60
      
      # 规则配置
      rules:
        refresh-interval: 60
        max-rules: 1000
      
      # 缓存配置
      cache:
        enabled: true
        ttl: 300
        max-size: 10000
